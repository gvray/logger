<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>@gvray/logger - ESM Example</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      background: #1a1a2e;
      color: #eee;
    }

    h1 {
      color: #00d9ff;
    }

    .tag {
      background: #7b68ee;
      color: white;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 12px;
      margin-left: 10px;
    }

    a {
      color: #00d9ff;
    }

    .controls {
      margin: 20px 0;
    }

    button {
      background: #0f3460;
      color: #00d9ff;
      border: 1px solid #00d9ff;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      margin: 5px;
      font-size: 14px;
    }

    button:hover {
      background: #1a4a7a;
    }

    .section {
      background: #16213e;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }

    .section h3 {
      margin-top: 0;
      color: #7b68ee;
    }

    code {
      background: #0f3460;
      padding: 2px 6px;
      border-radius: 4px;
    }

    pre {
      background: #0f3460;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
    }

    .hint {
      color: #888;
      font-size: 14px;
      margin-top: 20px;
    }
  </style>
</head>

<body>
  <h1>ğŸ“¦ ESM Example <span class="tag">ES Modules</span></h1>
  <p><a href="index.html">â† è¿”å›é¦–é¡µ</a></p>

  <div class="section">
    <h3>ä½¿ç”¨æ–¹å¼</h3>
    <pre><code>&lt;script type="module"&gt;
import { Logger, LogLevel } from './dist/gvray-logger.esm.js';

const logger = new Logger({ level: LogLevel.DEBUG });
logger.info('Hello from ESM!');
&lt;/script&gt;</code></pre>
  </div>

  <div class="controls">
    <h3>æµ‹è¯•æŒ‰é’®</h3>
    <button onclick="testBasic()">åŸºç¡€æ—¥å¿—</button>
    <button onclick="testLevels()">æ‰€æœ‰çº§åˆ«</button>
    <button onclick="testObjects()">å¯¹è±¡æ‰“å°</button>
    <button onclick="testNamespace()">å‘½åç©ºé—´</button>
    <button onclick="testMiddleware()">ä¸­é—´ä»¶</button>
    <button onclick="testColors()">é¢œè‰²åˆ‡æ¢</button>
  </div>

  <p class="hint">ğŸ’¡ æ‰“å¼€æµè§ˆå™¨ DevTools Console (F12) æŸ¥çœ‹è¾“å‡º</p>

  <script type="module">
    import {
      Logger,
      LogLevel,
      prefixMiddleware,
      jsonMiddleware,
      redactMiddleware
    } from '../../dist/gvray-logger.esm.js';

    // æš´éœ²åˆ°å…¨å±€ä¾›æŒ‰é’®è°ƒç”¨
    window.Logger = Logger;
    window.LogLevel = LogLevel;
    window.prefixMiddleware = prefixMiddleware;
    window.jsonMiddleware = jsonMiddleware;
    window.redactMiddleware = redactMiddleware;

    // åŸºç¡€æ—¥å¿—æµ‹è¯•
    window.testBasic = function () {
      console.clear();
      console.log('%c=== ESM åŸºç¡€æ—¥å¿—æµ‹è¯• ===', 'color: #00d9ff; font-weight: bold');

      const logger = new Logger({
        level: LogLevel.DEBUG,
        timestamp: 'time'
      });

      logger.info('Hello from ESM!');
      logger.debug('This is a debug message');
      logger.info('This is an info message');
      logger.warning('This is a warning');
    };

    // æ‰€æœ‰çº§åˆ«æµ‹è¯•
    window.testLevels = function () {
      console.clear();
      console.log('%c=== æ‰€æœ‰æ—¥å¿—çº§åˆ« ===', 'color: #00d9ff; font-weight: bold');

      const logger = new Logger({ level: LogLevel.TRACE });

      logger.trace('TRACE - æœ€è¯¦ç»†çš„è¿½è¸ªä¿¡æ¯');
      logger.debug('DEBUG - è°ƒè¯•ä¿¡æ¯');
      logger.info('INFO - ä¸€èˆ¬ä¿¡æ¯');
      logger.warning('WARNING - è­¦å‘Šä¿¡æ¯');
      logger.error('ERROR - é”™è¯¯ä¿¡æ¯');
      logger.fatal('FATAL - è‡´å‘½é”™è¯¯');
    };

    // å¯¹è±¡æ‰“å°æµ‹è¯•
    window.testObjects = function () {
      console.clear();
      console.log('%c=== å¯¹è±¡æ·±åº¦æ‰“å° ===', 'color: #00d9ff; font-weight: bold');

      const logger = new Logger({ level: LogLevel.DEBUG });

      const user = {
        id: 1,
        name: 'John Doe',
        email: 'john@example.com',
        settings: {
          theme: 'dark',
          notifications: { email: true, push: false }
        }
      };

      logger.info('ç”¨æˆ·ä¿¡æ¯:', user);
      logger.debug('æ•°ç»„ç¤ºä¾‹:', [1, 2, 3, { nested: true }]);
      logger.info('å¤šä¸ªå‚æ•°:', 'name', 123, { key: 'value' });
    };

    // å‘½åç©ºé—´æµ‹è¯•
    window.testNamespace = function () {
      console.clear();
      console.log('%c=== å‘½åç©ºé—´ / å­Logger ===', 'color: #00d9ff; font-weight: bold');

      const app = new Logger({ namespace: 'app', timestamp: 'time' });
      const db = app.child('database');
      const http = app.child('http');
      const auth = http.child('auth');

      app.info('åº”ç”¨å¯åŠ¨');
      db.info('æ•°æ®åº“å·²è¿æ¥');
      http.info('HTTP æœåŠ¡å™¨ç›‘å¬ç«¯å£ 3000');
      auth.debug('å¤„ç†è®¤è¯è¯·æ±‚');
    };

    // ä¸­é—´ä»¶æµ‹è¯•
    window.testMiddleware = function () {
      console.clear();
      console.log('%c=== ä¸­é—´ä»¶ç¤ºä¾‹ ===', 'color: #00d9ff; font-weight: bold');

      // Prefix ä¸­é—´ä»¶
      const prefixed = new Logger({ level: LogLevel.DEBUG });
      prefixed.use(prefixMiddleware('[SYSTEM]'));
      prefixed.info('å¸¦å‰ç¼€çš„æ¶ˆæ¯');

      // è„±æ•ä¸­é—´ä»¶
      const secure = new Logger({ level: LogLevel.DEBUG });
      secure.use(redactMiddleware(['password123', /\d{4}-\d{4}/]));
      secure.info('å¯†ç : password123, å¡å·: 1234-5678');

      // JSON è¾“å‡º
      const json = new Logger({ level: LogLevel.DEBUG, colors: false });
      json.use(jsonMiddleware());
      json.info('JSON æ ¼å¼è¾“å‡º');
    };

    // é¢œè‰²åˆ‡æ¢æµ‹è¯•
    window.testColors = function () {
      console.clear();
      console.log('%c=== é¢œè‰²åˆ‡æ¢ ===', 'color: #00d9ff; font-weight: bold');

      const logger = new Logger({ level: LogLevel.DEBUG });

      logger.info('é»˜è®¤å¸¦é¢œè‰²');
      logger.disableColors();
      logger.info('é¢œè‰²å·²ç¦ç”¨');
      logger.enableColors();
      logger.info('é¢œè‰²å·²æ¢å¤');
    };

    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡
    console.log('%câœ… ESM æ¨¡å—åŠ è½½æˆåŠŸ!', 'color: #32cd32; font-weight: bold');
    console.log('Logger:', Logger);
    console.log('LogLevel:', LogLevel);
  </script>
</body>

</html>